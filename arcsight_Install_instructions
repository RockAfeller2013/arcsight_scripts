# Quick Instrustions to install ArcSight ESM 7.2 in a Lab Environment on CentOS 7.6
# Refer to full details ESM 7.2 Installation Guide, although it is pretty straight forward.
# https://community.microfocus.com/t5/ESM-and-ESM-Express/ESM-7-2-Installation-Guide/ta-p/1661014
# Download the software - https://entitlement.microfocus.com/mysoftware/index
##---------------------------------------------------------------------------------------------------
CentOS Configuration

Download CentOS 7.6 from http://archive.kernel.org/centos-vault/7.6.1810/isos/x86_64/CentOS-7-x86_64-DVD-1810.iso
Install CentOS Components;
- Select Basic Web Server
Seletect Add-ons
- Select GNOME Desktop 
- Select Compatibility Libraries 
- Select Development Tool
- System Admin Tools

Single Partions to of 250 GB is fine, this Arcsight will install in /opt/arcsight folder. 
Create Partions; 

/opt  > minimum 100 GB
/tmp  > minimum  10 GB

- Ignore IPV6 
- Enable DHCP
- Setup NTP Time
- Set Hostname
#---------------------------------------------------------------------------------------------------
Manager Host Name Resolution
Before ESM installation, make sure that the host machine's hostname is resolvable,
otherwise, Manager setup will not complete successfully. Use ping to verify the
hostname, and fix any issues to avoid errors during Manager setup.

Mapping 127.0.0.1 to localhost
Make sure that the IP address 127.0.0.1 is resolved to localhost in the /etc/hosts file,
otherwise, the ESM installation will fail. This applies to IPv4 and IPv6 systems.
#---------------------------------------------------------------------------------------------------
systemctl stop packagekit 
systemctl disable packagekit
reboot
#---------------------------------------------------------------------------------------------------
sudo yum install -y tzdata
sudo yum install -y fontconfig \dejavu-sans-fonts
sudo yum install -y unzip  
sudo yum install -y nano
#yum -y install lvm2 zip unzip xev xauth fontconfig dejavu-sans-fonts mdadm bind-utils psmisc pciutils lsof sysstat
#---------------------------------------------------------------------------------------------------
// Set HOSTNAME, you can change the IP Address, but you can NEVER chance the HOSTNAME after ESM Install
sudo cat > /etc/hosts << EOF
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.1.1 hostname hostanme.localdomain
EOF
#---------------------------------------------------------------------------------------------------
sudo cat /etc/sysconfig/network << EOF
HOSTNAME=myserver
EOF
#---------------------------------------------------------------------------------------------------
hostnamectl set-hostname mysever
#---------------------------------------------------------------------------------------------------
Check NTP
timedatectl status
timedatectl set-ntp true
#---------------------------------------------------------------------------------------------------
echo "Disable Firewall for Lab"
sudo systemctl disable firewalld
sudo systemctl stop firewalld
sudo systemctl status firewalld
#---------------------------------------------------------------------------------------------------
Use SCP to copy installer file to /tmp and the license file
tar xvf ArcSightESMSuite-7.0.0.xxxx.1.tar
#---------------------------------------------------------------------------------------------------
Run prepare system script
/tmp/Toos/prepare_system.sh
reboot
#---------------------------------------------------------------------------------------------------
#echo "LOGIN into CONSOLE as arcsight and run installer in local console"
su arcsight {Confirme - you must run this install as arcsight in console}
chmod +x ArcSightESMSuite.bin
./ArcSightESMSuite.bin -i console
or 
./ArcSightESMSuite.bin, for GUI mode, if you are using X Window.)
#---------------------------------------------------------------------------------------------------
//Run as arcsight
/opt/arcsight/manager/bin/arcsight firstbootsetup -boxster -soft -i console
or
set Retention to 1 day for lab
#---------------------------------------------------------------------------------------------------
//Login as root
/opt/arcsight/manager/bin/setup_services.sh
#---------------------------------------------------------------------------------------------------
// START SERVICES as arcsight user
/etc/init.d/arcsight_services status
/etc/init.d/arcsight_services start
/etc/init.d/arcsight_services stop all
/etc/init.d/arcsight_services start all
#---------------------------------------------------------------------------------------------------
//Set the hostname of the ESM Ip address and hostaneme in local hosts file
Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --ignore-certificate-errors &> /dev/null &
// Access 
https://arcsight:8443
#---------------------------------------------------------------------------------------------------
// Uninstall ESM
sudo /tmp/Tools/stop_services.sh
sudo rm -rf opt/arcsight 
//Run as root
sudo /opt/arcsight/manager/bin/remove_services.sh 
// Run as arcsight
/opt/arcsight/suite/UninstallerData/Uninstall_ArcSight_ESM_Suite_7.2.0.0 
#---------------------------------------------------------------------------------------------------

